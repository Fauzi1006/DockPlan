<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DockPlan - Executive Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.js"></script>
    
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f1f5f9; overflow-x: hidden; color: #334155; }
        
        /* --- SIDEBAR ENTERPRISE THEME --- */
        .sidebar { 
            width: 260px; 
            background: #0b1121; 
            color: #94a3b8; 
            position: fixed; 
            top: 0; left: 0; height: 100%; 
            z-index: 50; 
            border-right: 1px solid #1e293b; 
            transition: all 0.3s;
            display: flex; flex-direction: column;
            overflow: hidden;
        }
        .sidebar.collapsed { width: 70px; }
        .sidebar.collapsed .logo-text, .sidebar.collapsed .nav-text { display: none; }
        .sidebar.collapsed .nav-item { justify-content: center; padding: 14px 0; }
        
        .nav-item { 
            display: flex; align-items: center; 
            padding: 12px 20px; margin: 4px 12px; 
            border-radius: 6px; font-size: 12.5px; font-weight: 600; 
            cursor: pointer; transition: all 0.2s; color: #94a3b8; letter-spacing: 0.3px;
        }
        .nav-item:hover { background: rgba(255,255,255,0.05); color: #f8fafc; }
        .nav-item.active { background: #1e293b; color: #38bdf8; border-left: 3px solid #38bdf8; border-radius: 4px; }
        
        .main-content { margin-left: 260px; transition: margin-left 0.3s; padding-bottom: 40px; }
        .main-content.expanded { margin-left: 70px; }
        
        .mobile-only-btn { display: none; }
        .desktop-logo { display: flex; }

        /* --- MOBILE BOTTOM BAR --- */
        @media (max-width: 768px) {
            .sidebar {
                width: 100% !important; height: 70px; 
                top: auto; bottom: 0; left: 0;
                flex-direction: row; justify-content: space-around; padding: 0;
                border-top: 1px solid #1e293b; box-shadow: 0 -4px 20px rgba(0,0,0,0.15);
                z-index: 9999; 
            }
            .main-content { margin-left: 0 !important; padding-bottom: 200px !important; }
            .main-content.expanded { margin-left: 0 !important; }
            .desktop-logo { display: none !important; }
            .mobile-only-btn { display: flex; flex-direction: column; align-items: center; justify-content: center; color: #ef4444; }

            .nav-item {
                flex-direction: column; margin: 0; padding: 8px 0; width: 100%; text-align: center; border-radius: 0; font-size: 10px; justify-content: center;
            }
            .nav-item.active { border-left: none; border-bottom: 3px solid #38bdf8; background: transparent; }
            .nav-item i { margin-bottom: 4px; font-size: 18px; }
            .nav-item .nav-text { display: block; font-size: 9px; }
            .sidebar > div.p-4 { display: none; } 
            .copyright-footer { bottom: 70px; font-size: 8px; padding: 5px; }
        }

        /* --- STATS CARDS MODERN --- */
        .stat-card { background: white; border-radius: 10px; padding: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.02); border: 1px solid #e2e8f0; display: flex; justify-content: space-between; align-items: center; transition: transform 0.2s; position: relative; overflow: hidden; }
        .stat-card:hover { transform: translateY(-2px); box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        .stat-card::before { content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 3px; }
        .stat-card.blue::before { background: #3b82f6; }
        .stat-card.red::before { background: #ef4444; }
        .stat-card.emerald::before { background: #10b981; }
        .stat-card.slate::before { background: #64748b; }
        .icon-box { width: 44px; height: 44px; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 18px; }

        /* --- TABLE ENTERPRISE --- */
        .table-container { background: white; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.04); border: 1px solid #cbd5e1; overflow: hidden; }
        table { border-collapse: collapse; width: 100%; table-layout: fixed; }
        thead { background: #1e293b; color: #f8fafc; }
        thead th { padding: 12px 6px; font-size: 10.5px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; border-right: 1px solid #334155; border-bottom: 1px solid #334155; vertical-align: middle; text-align: center; }
        thead th:last-child { border-right: none; }
        td { padding: 10px 6px; font-size: 11px; font-weight: 500; border-bottom: 1px solid #e2e8f0; border-right: 1px solid #e2e8f0; vertical-align: middle; text-align: center; word-wrap: break-word; color: #475569; }
        td:last-child { border-right: none; }
        tbody tr:nth-child(even) { background-color: #f8fafc; }
        tbody tr:hover { background-color: #f1f5f9; }
        
        /* --- UTILS & FORMS --- */
        input[type="checkbox"] { width: 15px; height: 15px; cursor: pointer; accent-color: #2563eb; }
        button:disabled { opacity: 0.5; cursor: not-allowed; }
        
        .form-input { width: 100%; padding: 10px 12px; border: 1px solid #cbd5e1; border-radius: 6px; font-size: 12px; text-transform: uppercase; font-weight: 600; color: #334155; background: #fff; transition: all 0.2s; box-shadow: inset 0 1px 2px rgba(0,0,0,0.02); }
        .form-input:focus { border-color: #3b82f6; outline: none; box-shadow: 0 0 0 3px rgba(59,130,246,0.15); }
        .status-waiting { color: #dc2626; font-size: 9.5px; font-weight: 700; letter-spacing: 0.5px; background: #fee2e2; padding: 2px 6px; border-radius: 4px; display: inline-block; line-height: 1.2;}

        /* SCROLLBAR */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: #f1f5f9; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        
        /* FOOTER */
        .copyright-footer { position: fixed; bottom: 0; left: 0; width: 100%; text-align: center; padding: 10px; background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(5px); border-top: 1px solid #e2e8f0; font-size: 10px; font-weight: 600; color: #94a3b8; text-transform: uppercase; letter-spacing: 1px; z-index: 40; pointer-events: none; }
        @media (max-width: 768px) { .copyright-footer { bottom: 70px !important; font-size: 8px; padding: 6px; } }
    </style>
</head>
<body class="h-screen flex overflow-hidden">

    <aside id="sidebar" class="sidebar">
        <div class="desktop-logo h-16 w-full items-center px-6 border-b border-slate-800 bg-[#070b14]">
            <div class="w-8 h-8 rounded bg-gradient-to-br from-blue-500 to-blue-700 flex items-center justify-center shadow-md mr-3 shrink-0">
                <i class="fas fa-truck-fast text-white text-sm"></i>
            </div>
            <div class="logo-text"> 
                <h1 class="text-white font-bold text-lg tracking-tight leading-tight">DockPlan</h1>
                <p class="text-[8.5px] text-blue-400 font-semibold uppercase tracking-[0.2em]">Logistics Mgmt</p>
            </div>
        </div>

        <nav class="flex-1 w-full py-0 md:py-6 space-y-0 md:space-y-1 flex md:block items-center md:items-stretch justify-around">
            
            <div onclick="showPage('dashboard-stats')" id="menu-dashboard-stats" class="nav-item active">
                <i class="fas fa-chart-pie w-6 text-center text-lg md:text-base"></i>
                <span class="nav-text">DASHBOARD</span>
            </div>

            <div onclick="showPage('input')" id="menu-input" class="nav-item">
                <i class="fas fa-keyboard w-6 text-center text-lg md:text-base"></i>
                <span class="nav-text">DATA ENTRY</span>
            </div>
            
            <div onclick="showPage('dashboard')" id="menu-dashboard" class="nav-item">
                <i class="fas fa-desktop w-6 text-center text-lg md:text-base"></i>
                <span class="nav-text">MONITORING</span>
            </div>

            <div onclick="showPage('history')" id="menu-history" class="nav-item">
                <i class="fas fa-history w-6 text-center text-lg md:text-base"></i>
                <span class="nav-text">HISTORY</span>
            </div>

            <div onclick="logout()" class="nav-item mobile-only-btn">
                <i class="fas fa-sign-out-alt w-6 text-center text-lg"></i>
                <span class="nav-text">KELUAR</span>
            </div>
        </nav>

        <div class="p-5 border-t border-slate-800 space-y-3 w-full hidden md:block">
            <button onclick="logout()" class="w-full py-2.5 rounded-md bg-slate-800 text-slate-300 text-[11px] font-semibold hover:bg-red-600 hover:text-white transition-colors duration-300 flex items-center justify-center gap-2 border border-slate-700 hover:border-red-500 shadow-sm">
                <i class="fas fa-sign-out-alt"></i> SIGN OUT
            </button>

            <button onclick="resetData()" class="w-full py-2 rounded-md text-slate-500 text-[10px] font-semibold hover:text-slate-300 transition-colors flex items-center justify-center gap-2">
                <i class="fas fa-trash-alt"></i> DB RESET
            </button>
        </div>
    </aside>

    <main id="main-content" class="main-content flex-1 h-full overflow-y-auto pb-20 relative">
        <header class="bg-white h-16 border-b border-slate-200 flex items-center justify-between px-6 sticky top-0 z-30 shadow-sm backdrop-blur-md bg-white/90">
            <div class="flex items-center gap-4">
                <button onclick="toggleSidebar()" class="text-slate-400 hover:text-blue-600 transition"><i class="fas fa-bars text-lg"></i></button>
                <div>
                    <h2 class="text-lg font-bold text-slate-800 tracking-tight leading-tight">DOCKING PLANNING SYSTEM</h2>
                    <p class="text-[10px] text-blue-600 font-semibold uppercase tracking-widest" id="page-subtitle">ANALYTICS & PERFORMANCE</p>
                </div>
            </div>
            <div class="flex items-center gap-3">
                <div class="text-right hidden sm:block">
                    <p class="text-[11px] font-bold text-slate-700" id="header-user-name">Loading...</p>
                    <p class="text-[9px] font-semibold text-slate-400 uppercase tracking-wider" id="header-user-role">Role</p>
                </div>
                <div class="w-9 h-9 rounded-full bg-slate-100 border border-slate-200 flex items-center justify-center text-blue-600 shadow-inner"><i class="fas fa-user-tie text-sm"></i></div>
            </div>
        </header>

        <div class="p-4 md:p-6 max-w-[100%] mx-auto">

            <div id="view-dashboard-stats" class="space-y-4 md:space-y-6">
                <div class="grid grid-cols-2 lg:grid-cols-4 gap-3 md:gap-5">
                    <div class="stat-card slate flex-col md:flex-row justify-center md:justify-between">
                        <div class="text-center md:text-left w-full">
                            <p class="text-[9.5px] font-semibold text-slate-500 uppercase tracking-widest truncate mb-1">TOTAL CLOSED</p>
                            <h3 class="text-2xl md:text-3xl font-bold text-slate-800 leading-none" id="analytic-total">0</h3>
                        </div>
                        <div class="icon-box bg-slate-50 text-slate-400 hidden md:flex"><i class="fas fa-box-check"></i></div>
                    </div>
                    <div class="stat-card blue flex-col md:flex-row justify-center md:justify-between">
                        <div class="text-center md:text-left w-full">
                            <p class="text-[9.5px] font-semibold text-slate-500 uppercase tracking-widest truncate mb-1">AVG LEAD TIME</p>
                            <h3 class="text-2xl md:text-3xl font-bold text-blue-600 leading-none"><span id="analytic-avg">0</span> <span class="text-[11px] font-semibold text-slate-400 uppercase">Hari</span></h3>
                        </div>
                        <div class="icon-box bg-blue-50 text-blue-500 hidden md:flex"><i class="fas fa-stopwatch"></i></div>
                    </div>
                    <div class="stat-card emerald flex-col md:flex-row justify-center md:justify-between">
                        <div class="text-center md:text-left w-full">
                            <p class="text-[9.5px] font-semibold text-slate-500 uppercase tracking-widest truncate mb-1">FASTEST DELIVERY</p>
                            <h3 class="text-2xl md:text-3xl font-bold text-emerald-600 leading-none"><span id="analytic-min">0</span> <span class="text-[11px] font-semibold text-slate-400 uppercase">Hari</span></h3>
                        </div>
                        <div class="icon-box bg-emerald-50 text-emerald-500 hidden md:flex"><i class="fas fa-bolt"></i></div>
                    </div>
                    <div class="stat-card red flex-col md:flex-row justify-center md:justify-between">
                        <div class="text-center md:text-left w-full">
                            <p class="text-[9.5px] font-semibold text-slate-500 uppercase tracking-widest truncate mb-1">LONGEST DELIVERY</p>
                            <h3 class="text-2xl md:text-3xl font-bold text-red-600 leading-none"><span id="analytic-max">0</span> <span class="text-[11px] font-semibold text-slate-400 uppercase">Hari</span></h3>
                        </div>
                        <div class="icon-box bg-red-50 text-red-500 hidden md:flex"><i class="fas fa-exclamation-triangle"></i></div>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 md:gap-5">
                    <div class="bg-white p-5 rounded-xl border border-slate-200 shadow-sm flex flex-col">
                        <h4 class="text-[11px] font-semibold text-slate-600 mb-4 uppercase tracking-wider text-center border-b border-slate-100 pb-2"><i class="fas fa-chart-pie text-red-500 mr-2"></i> Kecepatan Proses</h4>
                        <div class="relative w-full h-[220px]">
                            <canvas id="chartFastSlow"></canvas>
                        </div>
                    </div>
                    <div class="bg-white p-5 rounded-xl border border-slate-200 shadow-sm flex flex-col">
                        <h4 class="text-[11px] font-semibold text-slate-600 mb-4 uppercase tracking-wider text-center border-b border-slate-100 pb-2"><i class="fas fa-chart-bar text-blue-500 mr-2"></i> Distribusi (Hari)</h4>
                        <div class="relative w-full h-[220px]">
                            <canvas id="chartDistribution"></canvas>
                        </div>
                    </div>
                    <div class="bg-white p-5 rounded-xl border border-slate-200 shadow-sm flex flex-col">
                        <h4 class="text-[11px] font-semibold text-slate-600 mb-4 uppercase tracking-wider text-center border-b border-slate-100 pb-2"><i class="fas fa-chart-line text-emerald-500 mr-2"></i> Trend Bulanan</h4>
                        <div class="relative w-full h-[220px]">
                            <canvas id="chartMonthly"></canvas>
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="view-dashboard" class="hidden space-y-4 md:space-y-6">
                <div class="grid grid-cols-3 gap-2 md:gap-5">
    
                    <div class="stat-card slate flex-col md:flex-row items-start md:items-center justify-center md:justify-between p-3 md:p-5">
                        <div class="text-center md:text-left w-full">
                            <p class="text-[9px] font-semibold text-slate-500 uppercase tracking-widest truncate mb-1">TOTAL ACTIVE</p>
                            <h3 class="text-xl md:text-3xl font-bold text-slate-800 leading-none" id="stat-total">0</h3>
                        </div>
                        <div class="icon-box bg-slate-50 text-slate-400 hidden md:flex"><i class="fas fa-layer-group"></i></div>
                    </div>

                    <div class="stat-card red flex-col md:flex-row items-start md:items-center justify-center md:justify-between p-3 md:p-5">
                        <div class="text-center md:text-left w-full">
                            <p class="text-[9px] font-semibold text-slate-500 uppercase tracking-widest truncate mb-1">WAITING/PENDING</p>
                            <h3 class="text-xl md:text-3xl font-bold text-red-600 leading-none" id="stat-pending">0</h3>
                        </div>
                        <div class="icon-box bg-red-50 text-red-500 hidden md:flex"><i class="fas fa-hourglass-half"></i></div>
                    </div>

                    <div class="stat-card emerald flex-col md:flex-row items-start md:items-center justify-center md:justify-between p-3 md:p-5">
                        <div class="text-center md:text-left w-full">
                            <p class="text-[9px] font-semibold text-slate-500 uppercase tracking-widest truncate mb-1">CONFIRMED</p>
                            <h3 class="text-xl md:text-3xl font-bold text-emerald-600 leading-none" id="stat-confirmed">0</h3>
                        </div>
                        <div class="icon-box bg-emerald-50 text-emerald-500 hidden md:flex"><i class="fas fa-calendar-check"></i></div>
                    </div>

                </div>

                <div class="flex flex-col md:flex-row justify-between items-center gap-3 bg-white p-3 md:p-4 rounded-xl border border-slate-200 shadow-sm">
                    <div class="relative w-full md:w-[350px]">
                        <i class="fas fa-search absolute left-3.5 top-3 text-slate-400 text-sm"></i>
                        <input type="search" id="searchInput" autocomplete="new-password" readonly onfocus="this.removeAttribute('readonly');" onblur="this.setAttribute('readonly','readonly');" onkeyup="renderTable()" placeholder="Search DN, Vendor, Driver..." class="pl-10 pr-3 py-2.5 bg-slate-50 border border-slate-200 rounded-lg w-full text-xs font-semibold text-slate-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:bg-white uppercase transition-all">
                    </div>
                    
                    <div class="flex gap-2 w-full md:w-auto">
                        <button id="btn-delete-bulk" onclick="deleteSelected()" disabled class="flex-1 md:flex-none bg-white border border-red-200 text-red-600 px-4 py-2.5 rounded-lg text-[11px] font-bold hover:bg-red-50 transition shadow-sm flex items-center justify-center gap-2 disabled:bg-slate-50 disabled:border-slate-200 disabled:text-slate-400">
                            <i class="fas fa-trash-alt"></i> HAPUS (<span id="selected-count">0</span>)
                        </button>

                        <button onclick="exportToExcel()" class="flex-1 md:flex-none bg-emerald-600 text-white px-4 py-2.5 rounded-lg text-[11px] font-bold hover:bg-emerald-700 transition shadow-sm flex items-center justify-center gap-2">
                            <i class="fas fa-file-excel"></i> EXCEL
                        </button>
                    </div>
                </div>

                <div id="mobile-view" class="md:hidden space-y-3 mb-20"></div>

                <div class="table-container hidden md:block">
                    <div class="overflow-x-auto">
                        <table class="w-full" id="monitoringTable">
                            <thead>
                                <tr>
                                    <th style="width: 35px;"><input type="checkbox" id="checkAll" onclick="toggleSelectAll()"></th>
                                    <th style="width: 40px;">NO</th>
                                    <th style="width: 90px;">CREATED</th>
                                    <th style="width: 120px;">NO DN</th>
                                    <th style="width: 150px;">CUSTOMER</th>
                                    <th style="width: 90px;">KOTA</th>
                                    <th style="width: 60px;">QTY<br>(TON)</th>
                                    <th style="width: 80px;">UNIT</th>
                                    <th style="width: 110px;">VENDOR</th>
                                    <th style="width: 130px;">NOPOL & DRIVER</th>
                                    <th style="width: 100px;">STUFFING</th>
                                    <th style="width: 100px;">BONGKAR</th>
                                    <th style="width: 50px;"><i class="fas fa-cog"></i></th>
                                </tr>
                            </thead>
                            <tbody id="table-body"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div id="view-history" class="hidden space-y-4 md:space-y-6">
                <div class="flex flex-col md:flex-row justify-between items-center gap-3 bg-white p-3 md:p-4 rounded-xl border border-slate-200 shadow-sm">
                    <div class="relative w-full md:w-[350px]">
                        <i class="fas fa-search absolute left-3.5 top-3 text-slate-400 text-sm"></i>
                        <input type="search" id="searchHistoryInput" autocomplete="new-password" readonly onfocus="this.removeAttribute('readonly');" onblur="this.setAttribute('readonly','readonly');" onkeyup="renderHistory()" placeholder="Search History Data..." class="pl-10 pr-3 py-2.5 bg-slate-50 border border-slate-200 rounded-lg w-full text-xs font-semibold text-slate-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:bg-white uppercase transition-all">
                    </div>
                    
                    <div class="flex gap-2 w-full md:w-auto">
                        <button id="btn-delete-history" onclick="deleteSelected()" disabled class="flex-1 md:flex-none bg-white border border-red-200 text-red-600 px-4 py-2.5 rounded-lg text-[11px] font-bold hover:bg-red-50 transition shadow-sm flex items-center justify-center gap-2 disabled:bg-slate-50 disabled:border-slate-200 disabled:text-slate-400">
                            <i class="fas fa-trash-alt"></i> HAPUS (<span id="selected-count-history">0</span>)
                        </button>
                    </div>
                </div>

                <div id="mobile-view-history" class="md:hidden space-y-3 mb-20"></div>

                <div class="table-container hidden md:block">
                    <div class="overflow-x-auto">
                        <table class="w-full" id="historyTable">
                            <thead>
                                <tr>
                                    <th style="width: 35px;"><input type="checkbox" id="checkAllHistory" onclick="toggleSelectAllHistory()"></th>
                                    <th style="width: 40px;">NO</th>
                                    <th style="width: 90px;">CREATED</th>
                                    <th style="width: 120px;">NO DN</th>
                                    <th style="width: 150px;">CUSTOMER</th>
                                    <th style="width: 90px;">KOTA</th>
                                    <th style="width: 60px;">QTY<br>(TON)</th>
                                    <th style="width: 80px;">UNIT</th>
                                    <th style="width: 110px;">VENDOR</th>
                                    <th style="width: 130px;">NOPOL & DRIVER</th>
                                    <th style="width: 100px;">STUFFING</th>
                                    <th style="width: 100px;">BONGKAR</th>
                                    <th style="width: 70px;">STATUS</th> 
                                </tr>
                            </thead>
                            <tbody id="table-body-history"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div id="view-input" class="hidden max-w-5xl mx-auto space-y-6">
                
                <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
                    <div class="px-6 py-4 border-b border-slate-100 bg-slate-50 flex justify-between items-center">
                        <h3 class="font-semibold text-slate-700 flex items-center gap-2 text-[13px] tracking-wide"><i class="fas fa-file-import text-blue-600"></i> IMPORT DATA SAP (MASSAL)</h3>
                    </div>
                    <div class="p-6 space-y-5">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                            <div>
                                <label class="text-[10.5px] font-semibold text-slate-500 uppercase block mb-1.5">Auto Vendor (Opsional)</label>
                                <input type="text" id="input-vendor-batch" class="form-input" placeholder="Set vendor untuk 1 batch">
                            </div>
                            <div>
                                <label class="text-[10.5px] font-semibold text-slate-500 uppercase block mb-1.5">Auto Unit (Opsional)</label>
                                <input type="text" id="input-unit-batch" class="form-input" placeholder="Set tipe unit (CDD/FUSO/TNR)">
                            </div>
                        </div>
                        <div>
                             <textarea id="paste-area" class="w-full h-36 p-4 border border-slate-300 rounded-lg font-mono text-xs focus:ring-2 focus:ring-blue-500 outline-none bg-slate-50 text-slate-700 uppercase leading-relaxed shadow-inner" placeholder="PASTE DATA DARI EXCEL / SAP DISINI..."></textarea>
                        </div>
                        <div class="flex justify-end">
                            <button onclick="processPaste()" class="px-6 py-2.5 rounded-lg text-[11px] font-bold text-white bg-blue-600 hover:bg-blue-700 shadow-md transition-all flex items-center gap-2 tracking-wide">
                                <i class="fas fa-cloud-upload-alt"></i> PROSES IMPORT DATA
                            </button>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
                    <div class="px-6 py-4 border-b border-slate-100 bg-slate-50 flex justify-between items-center">
                        <h3 class="font-semibold text-slate-700 flex items-center gap-2 text-[13px] tracking-wide"><i class="fas fa-keyboard text-emerald-600"></i> INPUT MANUAL SINGLE</h3>
                    </div>
                    <div class="p-6">
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-4">
                            <div><label class="text-[10.5px] font-semibold text-slate-500 block mb-1.5">No DN *</label><input id="man-dn" class="form-input"></div>
                            <div><label class="text-[10.5px] font-semibold text-slate-500 block mb-1.5">Customer *</label><input id="man-cust" class="form-input"></div>
                            <div><label class="text-[10.5px] font-semibold text-slate-500 block mb-1.5">Kota</label><input id="man-kota" class="form-input"></div>
                            <div><label class="text-[10.5px] font-semibold text-slate-500 block mb-1.5">Qty (Ton)</label><input type="number" id="man-qty" class="form-input"></div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                            <div><label class="text-[10.5px] font-semibold text-slate-500 block mb-1.5">Jenis Unit</label><input id="man-unit" class="form-input"></div>
                            <div><label class="text-[10.5px] font-semibold text-slate-500 block mb-1.5">Vendor</label><input id="man-vendor" class="form-input"></div>
                            <div><label class="text-[10.5px] font-semibold text-slate-500 block mb-1.5">Nopol</label><input id="man-nopol" class="form-input"></div>
                            <div><label class="text-[10.5px] font-semibold text-slate-500 block mb-1.5">Nama Driver</label><input id="man-driver" class="form-input"></div>
                        </div>
                        <div class="flex justify-end gap-3 border-t border-slate-100 pt-5">
                            <button onclick="showPage('dashboard')" class="px-5 py-2.5 rounded-lg text-[11px] font-bold text-slate-500 border border-slate-300 hover:bg-slate-50 transition tracking-wide">BATAL</button>
                            <button onclick="saveManual()" class="px-6 py-2.5 rounded-lg text-[11px] font-bold text-white bg-emerald-600 hover:bg-emerald-700 shadow-md transition-all flex items-center gap-2 tracking-wide">
                                <i class="fas fa-save"></i> SIMPAN RECORD
                            </button>
                        </div>
                    </div>
                </div>

            </div>

        </div>
    </main>

    <div class="copyright-footer">
        2026 &copy; Ahmad Fauzi - DockPlan Enterprise - All Rights Reserved
    </div>

    <div id="login-screen" class="fixed inset-0 bg-[#070b14] z-[100] flex items-center justify-center transition-all duration-500 hidden">
        <div class="bg-white p-8 md:p-10 rounded-2xl shadow-2xl w-[90%] max-w-[400px] text-center relative overflow-hidden">
            <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-blue-600 to-blue-400"></div>
            <div class="w-16 h-16 bg-slate-50 border border-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-5 shadow-sm">
                <i class="fas fa-shield-alt text-blue-600 text-2xl"></i>
            </div>
            <h2 class="text-2xl font-bold text-slate-800 mb-1 tracking-tight">System Login</h2>
            <p class="text-[11px] font-semibold text-slate-400 mb-8 uppercase tracking-widest">DockPlan Logistics Management</p>
            
            <div class="space-y-5 text-left">
                <div>
                    <label class="text-[10px] font-semibold text-slate-500 ml-1 block mb-1">USERNAME / EMAIL</label>
                    <input type="text" id="username-input" class="w-full p-3 bg-slate-50 border border-slate-300 rounded-lg text-sm font-semibold focus:ring-2 focus:ring-blue-500 outline-none transition-all" placeholder="name@company.com">
                </div>
                <div>
                    <label class="text-[10px] font-semibold text-slate-500 ml-1 block mb-1">PASSWORD</label>
                    <input type="password" id="password-input" class="w-full p-3 bg-slate-50 border border-slate-300 rounded-lg text-sm font-semibold focus:ring-2 focus:ring-blue-500 outline-none transition-all" placeholder="••••••••">
                </div>
                <button onclick="prosesLogin()" class="w-full py-3.5 bg-blue-600 text-white rounded-lg font-bold text-sm hover:bg-blue-700 transition shadow-md flex items-center justify-center gap-2 mt-2">
                    <i class="fas fa-sign-in-alt"></i> SECURE LOGIN
                </button>
            </div>
            <p class="mt-8 text-[9px] text-slate-400 font-semibold uppercase tracking-widest">Authorized Personnel Only</p>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
    // --- 1. KONEKSI FIREBASE ---
    const firebaseConfig = {
      apiKey: "AIzaSyCHs4mqUYjDvdWH-HU0E6PGWsUu4yJG-kk",
      authDomain: "dockplan-system.firebaseapp.com",
      projectId: "dockplan-system",
      storageBucket: "dockplan-system.firebasestorage.app",
      messagingSenderId: "487876305197",
      appId: "1:487876305197:web:9a1d642d00f0bdf52fb3a4"
    };

    if (typeof firebase === 'undefined') {
        alert("ERROR: Script Firebase Library belum dimuat di bagian paling atas!");
    } else {
        if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
    }
    
    const db = firebase.firestore();
    const auth = firebase.auth();

    // --- 2. VARIABEL GLOBAL ---
    let localData = []; 
    let USER_ROLE = ''; 
    let USER_NAME = ''; 
    let chartDistInstance = null;
    let chartMonthlyInstance = null;
    let chartFastSlowInstance = null;

    // --- 3. SISTEM LOGIN ---
    function prosesLogin() {
        const email = document.getElementById('username-input').value.trim().toLowerCase();
        const pass = document.getElementById('password-input').value.trim();

        if (!email || !pass) { alert('Harap isi Email dan Password!'); return; }

        const btnLogin = document.querySelector('button[onclick="prosesLogin()"]');
        const textAsli = btnLogin.innerHTML;
        btnLogin.innerHTML = '<i class="fas fa-spinner fa-spin"></i> AUTHENTICATING...';
        btnLogin.disabled = true;

        auth.signInWithEmailAndPassword(email, pass)
            .then((cred) => {
                return db.collection('users').doc(email).get();
            })
            .then((doc) => {
                if (doc.exists) {
                    const data = doc.data();
                    localStorage.setItem('dockplan_session', JSON.stringify(data));
                    masukAplikasi(data.role, data.nama);
                } else {
                    alert('GAGAL: Email benar, tapi belum disetup di Database.');
                    auth.signOut();
                }
            })
            .catch((err) => {
                let msg = err.message;
                if(err.code === 'auth/invalid-credential') msg = "Password atau Email Salah.";
                alert('Login Gagal: ' + msg);
            })
            .finally(() => {
                btnLogin.innerHTML = textAsli;
                btnLogin.disabled = false;
            });
    }

    auth.onAuthStateChanged((user) => {
        if (user) {
            db.collection('users').doc(user.email).get().then((doc) => {
                if(doc.exists) {
                    const d = doc.data();
                    masukAplikasi(d.role, d.nama);
                }
            });
        } else {
            document.getElementById('login-screen').classList.remove('hidden');
        }
    });

    function masukAplikasi(role, nama) {
        USER_ROLE = role;
        USER_NAME = nama.toUpperCase(); 

        document.getElementById('login-screen').classList.add('hidden');
        document.getElementById('page-subtitle').innerText = `ANALYTICS & PERFORMANCE`;
        
        document.getElementById('header-user-name').innerText = USER_NAME;
        document.getElementById('header-user-role').innerText = role;

        const btnInput = document.getElementById('menu-input');
        const btnDelete = document.getElementById('btn-delete-bulk');
        const btnDeleteHistory = document.getElementById('btn-delete-history');
        const btnReset = document.querySelector('button[onclick="resetData()"]');
        
        if (role === 'ADMIN') {
            if(btnInput) btnInput.style.display = 'flex';
            if(btnDelete) btnDelete.style.display = 'flex';
            if(btnDeleteHistory) btnDeleteHistory.style.display = 'flex';
            if(btnReset) btnReset.style.display = 'flex';
        } else {
            if(btnInput) btnInput.style.display = 'none';
            if(btnDelete) btnDelete.style.display = 'none';
            if(btnDeleteHistory) btnDeleteHistory.style.display = 'none';
            if(btnReset) btnReset.style.display = 'none';
        }

        const searchBox = document.getElementById('searchInput');
        if(searchBox) searchBox.value = '';

        renderAnalytics();
        updateStats();
    }

    function logout() {
        if (confirm("Sign out dari aplikasi?")) {
            localStorage.removeItem('dockplan_session'); 
            auth.signOut().then(() => location.reload());
        }
    }

    // --- 4. RENDER TABLE & LOGIC ---
    db.collection("bookings").orderBy("created", "desc").onSnapshot((snapshot) => {
        localData = [];
        snapshot.forEach((doc) => {
            let d = doc.data();
            d.id = doc.id;
            localData.push(d);
        });
        
        const activePage = document.querySelector('.nav-item.active').id;
        if(activePage === 'menu-history') {
            renderHistory();
        } else if (activePage === 'menu-dashboard-stats') {
            renderAnalytics();
        } else {
            renderTable();
        }
        updateStats(); 
    });

    function isHistory(bongkarDateStr) {
        if (!bongkarDateStr) return false;
        const today = new Date();
        today.setHours(0,0,0,0);
        
        const bongkarDate = new Date(bongkarDateStr);
        const limit = new Date(bongkarDate);
        limit.setDate(limit.getDate() + 1);
        
        return today > limit;
    }

    function renderAnalytics() {
        let dataTampil = localData;

        if (USER_ROLE === 'VENDOR') {
            dataTampil = dataTampil.filter(item => item.vendor && item.vendor.toUpperCase() === USER_NAME);
        } else if (USER_ROLE === 'CUSTOMER') {
            dataTampil = dataTampil.filter(item => item.customer && item.customer.toUpperCase() === USER_NAME);
        }

        dataTampil = dataTampil.filter(item => isHistory(item.bongkar) && item.stuffing && item.bongkar);

        let totalClosed = dataTampil.length;
        let sumDays = 0, minDays = Infinity, maxDays = -1;
        let dist = { '0-1': 0, '2-3': 0, '4-5': 0, '>5': 0 };
        let monthly = {};

        dataTampil.forEach(item => {
            const dStuffing = new Date(item.stuffing);
            const dBongkar = new Date(item.bongkar);
            dStuffing.setHours(0,0,0,0);
            dBongkar.setHours(0,0,0,0);

            const diffDays = Math.max(0, Math.ceil((dBongkar - dStuffing) / (1000 * 60 * 60 * 24)));

            sumDays += diffDays;
            if (diffDays < minDays) minDays = diffDays;
            if (diffDays > maxDays) maxDays = diffDays;

            if (diffDays <= 1) dist['0-1']++;
            else if (diffDays <= 3) dist['2-3']++;
            else if (diffDays <= 5) dist['4-5']++;
            else dist['>5']++;

            const m = dBongkar.getMonth();
            const y = dBongkar.getFullYear();
            const key = `${y}-${String(m + 1).padStart(2, '0')}`;
            
            if (!monthly[key]) {
                monthly[key] = { count: 0, sum: 0, label: dBongkar.toLocaleString('id-ID', { month: 'short', year: 'numeric' }) };
            }
            monthly[key].count++;
            monthly[key].sum += diffDays;
        });

        if (minDays === Infinity) minDays = 0;
        if (maxDays === -1) maxDays = 0;
        let avgDays = totalClosed > 0 ? (sumDays / totalClosed).toFixed(1) : 0;

        document.getElementById('analytic-total').innerText = totalClosed.toLocaleString('id-ID');
        document.getElementById('analytic-avg').innerText = avgDays;
        document.getElementById('analytic-min').innerText = minDays;
        document.getElementById('analytic-max').innerText = maxDays;

        const distLabels = ['0-1 Hari', '2-3 Hari', '4-5 Hari', '> 5 Hari'];
        const distData = [dist['0-1'], dist['2-3'], dist['4-5'], dist['>5']];

        const sortedMonthKeys = Object.keys(monthly).sort();
        const monthLabels = sortedMonthKeys.map(k => monthly[k].label);
        const monthDataAvg = sortedMonthKeys.map(k => (monthly[k].sum / monthly[k].count).toFixed(1));
        const monthDataTotal = sortedMonthKeys.map(k => monthly[k].count);

        const fastCount = dist['0-1'] + dist['2-3'];
        const slowCount = dist['4-5'] + dist['>5'];

        if (chartDistInstance) chartDistInstance.destroy();
        if (chartMonthlyInstance) chartMonthlyInstance.destroy();
        if (chartFastSlowInstance) chartFastSlowInstance.destroy();

        Chart.defaults.font.family = "'Inter', sans-serif";
        Chart.defaults.color = '#64748b';

        const ctxDist = document.getElementById('chartDistribution').getContext('2d');
        chartDistInstance = new Chart(ctxDist, {
            type: 'bar',
            data: {
                labels: distLabels,
                datasets: [{
                    label: 'Volume',
                    data: distData,
                    backgroundColor: '#3b82f6',
                    borderRadius: 4,
                    barPercentage: 0.6
                }]
            },
            options: { 
                responsive: true, maintainAspectRatio: false, 
                scales: { 
                    y: { beginAtZero: true, grid: { borderDash: [2, 4], color: '#f1f5f9' }, ticks: { stepSize: 1, font: {size: 10} } },
                    x: { grid: { display: false }, ticks: { font: {size: 10} } }
                },
                plugins: { legend: { display: false }, tooltip: { cornerRadius: 4, padding: 10 } }
            }
        });

        const ctxMonthly = document.getElementById('chartMonthly').getContext('2d');
        chartMonthlyInstance = new Chart(ctxMonthly, {
            type: 'line',
            data: {
                labels: monthLabels,
                datasets: [
                    { label: 'Avg Lead Time', data: monthDataAvg, borderColor: '#10b981', backgroundColor: '#10b981', tension: 0.4, borderWidth: 2, pointRadius: 3, yAxisID: 'y' },
                    { type: 'bar', label: 'Volume', data: monthDataTotal, backgroundColor: '#cbd5e1', borderRadius: 4, barPercentage: 0.5, yAxisID: 'y1' }
                ]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                interaction: { mode: 'index', intersect: false },
                scales: {
                    x: { grid: { display: false }, ticks: { font: {size: 10} } },
                    y: { type: 'linear', display: true, position: 'left', grid: { borderDash: [2, 4], color: '#f1f5f9' }, ticks: { font: {size: 10} } },
                    y1: { type: 'linear', display: true, position: 'right', grid: { drawOnChartArea: false }, ticks: { stepSize: 1, font: {size: 10} } }
                },
                plugins: { legend: { position: 'bottom', labels: { boxWidth: 10, font: {size: 10} } }, tooltip: { cornerRadius: 4 } }
            }
        });

        const ctxFastSlow = document.getElementById('chartFastSlow').getContext('2d');
        chartFastSlowInstance = new Chart(ctxFastSlow, {
            type: 'doughnut',
            data: {
                labels: ['Cepat (≤ 3 Hari)', 'Lambat (> 3 Hari)'],
                datasets: [{
                    data: [fastCount, slowCount],
                    backgroundColor: ['#10b981', '#f43f5e'],
                    borderWidth: 0, hoverOffset: 4
                }]
            },
            options: { 
                responsive: true, maintainAspectRatio: false, cutout: '65%',
                plugins: { legend: { position: 'bottom', labels: { boxWidth: 12, padding: 15, font: {size: 10} } }, tooltip: { cornerRadius: 4 } }
            }
        });
    }

    function renderTable() {
        let dataTampil = localData;
        const filter = document.getElementById('searchInput').value.toUpperCase();

        if (USER_ROLE === 'VENDOR') {
            dataTampil = dataTampil.filter(item => item.vendor && item.vendor.toUpperCase() === USER_NAME);
        } 
        else if (USER_ROLE === 'CUSTOMER') {
            dataTampil = dataTampil.filter(item => item.customer && item.customer.toUpperCase() === USER_NAME);
        }

        dataTampil = dataTampil.filter(item => !isHistory(item.bongkar));

        if(filter) {
            dataTampil = dataTampil.filter(i => 
                (i.dn && i.dn.includes(filter)) || 
                (i.customer && i.customer.toUpperCase().includes(filter)) ||
                (i.kota && i.kota.toUpperCase().includes(filter)) ||
                (i.unit && i.unit.toUpperCase().includes(filter)) ||
                (i.vendor && i.vendor.toUpperCase().includes(filter)) ||
                (i.nopol && i.nopol.toUpperCase().includes(filter)) ||
                (i.driver && i.driver.toUpperCase().includes(filter))
            );
        }

        const tbody = document.getElementById('table-body');
        const mobileView = document.getElementById('mobile-view');
        
        tbody.innerHTML = ''; mobileView.innerHTML = '';
        document.getElementById('checkAll').checked = false;
        updateDeleteButton();

        if(dataTampil.length === 0) {
            tbody.innerHTML = `<tr><td colspan="13" class="text-center py-12 text-slate-400 font-semibold bg-white">No active records found.</td></tr>`;
            mobileView.innerHTML = `<div class="text-center py-10 text-slate-400 font-semibold bg-white rounded-lg border border-slate-200">No active records.</div>`;
            return;
        }

        dataTampil.forEach((item, idx) => {
            const dCreated = new Date(item.created);
            const showCreated = `${dCreated.getDate()}/${dCreated.getMonth()+1} <span class="text-[9px] text-slate-400 block">${String(dCreated.getHours()).padStart(2,'0')}:${String(dCreated.getMinutes()).padStart(2,'0')}</span>`;
            
            const formatJadwal = (val) => {
                if(!val) return '<span class="status-waiting"><i class="fas fa-clock mr-1"></i>WAITING</span>';
                const d = new Date(val); const months = ["Jan", "Feb", "Mar", "Apr", "Mei", "Jun", "Jul", "Agu", "Sep", "Okt", "Nov", "Des"];
                return `<div class="text-blue-700 text-[11px] font-bold tracking-wide">${d.getDate()} ${months[d.getMonth()]}</div>`;
            };

            const displayQty = Math.round(item.qty).toLocaleString('id-ID');

            const row = `
            <tr class="transition-colors hover:bg-slate-50">
                <td><input type="checkbox" class="row-chk" value="${item.id}" onclick="updateDeleteButton()"></td>
                <td class="font-semibold text-slate-400 text-[10px]">${idx+1}</td>
                <td class="text-[10px] font-semibold text-slate-500">${showCreated}</td>
                <td class="font-bold text-blue-700 text-[10.5px]">${item.dn}</td>
                <td class="font-semibold text-slate-700 text-[10.5px]">${item.customer}</td>
                <td class="font-semibold text-slate-500 text-[10.5px]">${item.kota}</td>
                <td class="font-bold text-slate-800">${displayQty}</td>
                <td class="font-semibold text-slate-500 text-[10.5px]">${item.unit}</td>
                <td class="font-semibold text-slate-600 text-[10.5px]">${item.vendor || '-'}</td>
                <td class="text-left px-3">
                    <div class="font-bold text-slate-700 text-[11px]">${item.nopol || '-'}</div>
                    <div class="font-semibold text-slate-400 text-[9.5px]">${item.driver || '-'}</div>
                </td>
                <td class="bg-yellow-50/50">${formatJadwal(item.stuffing)}</td>
                <td class="bg-emerald-50/50">${formatJadwal(item.bongkar)}</td>
                <td>
                    <button onclick="editItem('${item.id}')" class="text-blue-500 hover:text-blue-700 bg-blue-50 hover:bg-blue-100 p-1.5 rounded transition"><i class="fas fa-pencil-alt text-[10px]"></i></button>
                </td>
            </tr>`;
            tbody.innerHTML += row;

            const card = `
            <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-200 mb-3 relative overflow-hidden">
                <div class="flex justify-between items-start border-b border-slate-100 pb-3 mb-3">
                    <div class="w-2/3 pr-2">
                        <div class="flex items-center gap-2 mb-1.5">
                            <span class="bg-slate-100 text-slate-500 border border-slate-200 text-[9px] px-1.5 py-0.5 rounded font-bold">#${idx + 1}</span>
                            <span class="text-[9px] text-slate-400 font-semibold">${dCreated.getDate()}/${dCreated.getMonth()+1} ${String(dCreated.getHours()).padStart(2,'0')}:${String(dCreated.getMinutes()).padStart(2,'0')}</span>
                        </div>
                        <h4 class="font-bold text-blue-700 text-[13px] leading-tight mb-0.5 truncate">${item.dn}</h4>
                        <div class="text-[10px] font-semibold text-slate-500 uppercase truncate">${item.customer}</div>
                    </div>
                    <div class="text-right w-1/3">
                        <div class="font-bold text-lg text-slate-800 leading-none">${displayQty}</div>
                        <div class="text-[8px] font-semibold text-slate-400 mt-1 tracking-widest">TON</div>
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-3 mb-3 text-[10px]">
                    <div>
                        <span class="block text-[8.5px] text-slate-400 font-semibold uppercase mb-0.5">VENDOR / UNIT</span>
                        <b class="text-slate-700 block truncate">${item.vendor || '-'} <span class="text-slate-400 font-normal">(${item.unit})</span></b>
                    </div>
                    <div>
                        <span class="block text-[8.5px] text-slate-400 font-semibold uppercase mb-0.5">NOPOL / DRIVER</span>
                        <b class="text-slate-700 block truncate">${item.nopol || '-'} / <span class="text-slate-500 font-normal">${item.driver || '-'}</span></b>
                    </div>
                </div>
                <div class="flex gap-2 mb-4">
                    <div class="flex-1 bg-slate-50 p-2 rounded-lg border border-slate-100 text-center">
                        <div class="text-[8px] font-semibold text-slate-400 mb-1 uppercase tracking-wider">STUFFING</div>
                        ${formatJadwal(item.stuffing)}
                    </div>
                    <div class="flex-1 bg-slate-50 p-2 rounded-lg border border-slate-100 text-center">
                        <div class="text-[8px] font-semibold text-slate-400 mb-1 uppercase tracking-wider">BONGKAR</div>
                        ${formatJadwal(item.bongkar)}
                    </div>
                </div>
                <div class="flex justify-between items-center gap-3">
                    <label class="flex items-center gap-2 p-2 rounded-lg bg-slate-50 hover:bg-slate-100 cursor-pointer border border-slate-200 flex-1 justify-center transition-colors">
                        <input type="checkbox" class="row-chk w-3.5 h-3.5 accent-blue-600" value="${item.id}" onclick="updateDeleteButton()">
                        <span class="text-[9.5px] font-bold text-slate-500 tracking-wide">PILIH</span>
                    </label>
                    <button onclick="editItem('${item.id}')" class="bg-blue-50 text-blue-600 border border-blue-100 flex-1 py-2 rounded-lg text-[10px] font-bold hover:bg-blue-600 hover:text-white transition-colors flex items-center justify-center gap-1.5 tracking-wide">
                        <i class="fas fa-pencil-alt"></i> EDIT
                    </button>
                </div>
            </div>`;
            mobileView.innerHTML += card;
        });
    }

    function renderHistory() {
        let dataTampil = localData;
        const filter = document.getElementById('searchHistoryInput').value.toUpperCase();

        if (USER_ROLE === 'VENDOR') {
            dataTampil = dataTampil.filter(item => item.vendor && item.vendor.toUpperCase() === USER_NAME);
        } 
        else if (USER_ROLE === 'CUSTOMER') {
            dataTampil = dataTampil.filter(item => item.customer && item.customer.toUpperCase() === USER_NAME);
        }

        dataTampil = dataTampil.filter(item => isHistory(item.bongkar));

        if(filter) {
            dataTampil = dataTampil.filter(i => 
                (i.dn && i.dn.includes(filter)) || 
                (i.customer && i.customer.toUpperCase().includes(filter)) ||
                (i.kota && i.kota.toUpperCase().includes(filter)) ||
                (i.unit && i.unit.toUpperCase().includes(filter)) ||
                (i.vendor && i.vendor.toUpperCase().includes(filter)) ||
                (i.nopol && i.nopol.toUpperCase().includes(filter)) ||
                (i.driver && i.driver.toUpperCase().includes(filter))
            );
        }

        const tbody = document.getElementById('table-body-history');
        const mobileView = document.getElementById('mobile-view-history');
        
        tbody.innerHTML = ''; mobileView.innerHTML = '';
        document.getElementById('checkAllHistory').checked = false;
        const btnDel = document.getElementById('btn-delete-history');
        if(btnDel) { btnDel.disabled = true; document.getElementById('selected-count-history').innerText = '0'; }

        if(dataTampil.length === 0) {
            tbody.innerHTML = `<tr><td colspan="13" class="text-center py-12 text-slate-400 font-semibold bg-white">No history records found.</td></tr>`;
            mobileView.innerHTML = `<div class="text-center py-10 text-slate-400 font-semibold bg-white rounded-lg border border-slate-200">No history records.</div>`;
            return;
        }

        dataTampil.forEach((item, idx) => {
            const dCreated = new Date(item.created);
            const showCreated = `${dCreated.getDate()}/${dCreated.getMonth()+1} <span class="text-[9px] text-slate-400 block">${String(dCreated.getHours()).padStart(2,'0')}:${String(dCreated.getMinutes()).padStart(2,'0')}</span>`;
            
            const formatJadwal = (val) => {
                const d = new Date(val); const months = ["Jan", "Feb", "Mar", "Apr", "Mei", "Jun", "Jul", "Agu", "Sep", "Okt", "Nov", "Des"];
                return `<div class="text-slate-500 text-[11px] font-bold"><i class="fas fa-check-circle mr-1 text-emerald-500"></i>${d.getDate()} ${months[d.getMonth()]}</div>`;
            };

            const displayQty = Math.round(item.qty).toLocaleString('id-ID');

            const row = `
            <tr class="transition-colors hover:bg-slate-50 bg-slate-50/30">
                <td><input type="checkbox" class="row-chk" value="${item.id}" onclick="updateDeleteButton()"></td>
                <td class="font-semibold text-slate-400 text-[10px]">${idx+1}</td>
                <td class="text-[10px] font-semibold text-slate-400">${showCreated}</td>
                <td class="font-bold text-slate-600 text-[10.5px]">${item.dn}</td>
                <td class="font-semibold text-slate-500 text-[10.5px]">${item.customer}</td>
                <td class="font-semibold text-slate-400 text-[10.5px]">${item.kota}</td>
                <td class="font-bold text-slate-500">${displayQty}</td>
                <td class="font-semibold text-slate-400 text-[10.5px]">${item.unit}</td>
                <td class="font-semibold text-slate-500 text-[10.5px]">${item.vendor || '-'}</td>
                <td class="text-left px-3 opacity-80">
                    <div class="font-bold text-slate-600 text-[11px]">${item.nopol || '-'}</div>
                    <div class="font-semibold text-slate-400 text-[9.5px]">${item.driver || '-'}</div>
                </td>
                <td class="bg-white opacity-70">${formatJadwal(item.stuffing)}</td>
                <td class="bg-white opacity-70">${formatJadwal(item.bongkar)}</td>
                <td>
                    <span class="px-2 py-1 bg-slate-200 text-slate-500 text-[9px] font-bold rounded shadow-sm tracking-wide">CLOSED</span>
                </td>
            </tr>`;
            tbody.innerHTML += row;

            const card = `
            <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-200 mb-3 relative overflow-hidden grayscale-[0.2] opacity-90">
                <div class="absolute top-0 right-0 bg-slate-100 border-b border-l border-slate-200 text-slate-400 text-[8px] font-bold px-2 py-1 rounded-bl-lg tracking-widest">HISTORY</div>
                <div class="flex justify-between items-start border-b border-slate-100 pb-3 mb-3">
                    <div class="w-2/3 pr-2">
                        <div class="flex items-center gap-2 mb-1.5 mt-2">
                            <span class="bg-slate-100 text-slate-400 border border-slate-200 text-[9px] px-1.5 py-0.5 rounded font-bold">#${idx + 1}</span>
                            <span class="text-[9px] text-slate-400 font-semibold">${dCreated.getDate()}/${dCreated.getMonth()+1}</span>
                        </div>
                        <h4 class="font-bold text-slate-600 text-[13px] leading-tight mb-0.5 truncate">${item.dn}</h4>
                        <div class="text-[10px] font-semibold text-slate-400 uppercase truncate">${item.customer}</div>
                    </div>
                    <div class="text-right w-1/3 pt-3">
                        <div class="font-bold text-lg text-slate-500 leading-none">${displayQty}</div>
                        <div class="text-[8px] font-semibold text-slate-400 mt-1 tracking-widest">TON</div>
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-3 mb-4">
                     <div class="flex-1 bg-slate-50 p-2 rounded-lg border border-slate-100 text-center">
                        <div class="text-[8px] font-semibold text-slate-400 mb-1 uppercase tracking-wider">COMPLETED ON</div>
                        ${formatJadwal(item.bongkar)}
                    </div>
                     <div class="flex-1 flex items-center justify-center">
                        <label class="flex items-center gap-2 p-2 rounded-lg bg-white hover:bg-red-50 border border-slate-200 w-full justify-center transition-colors cursor-pointer text-slate-400 hover:text-red-500 hover:border-red-200">
                            <input type="checkbox" class="row-chk w-3.5 h-3.5 accent-red-500" value="${item.id}" onclick="updateDeleteButton()">
                            <span class="text-[9.5px] font-bold tracking-wide">PILIH HAPUS</span>
                        </label>
                    </div>
                </div>
            </div>`;
            mobileView.innerHTML += card;
        });
    }

    function editItem(id) {
        const item = localData.find(i => i.id === id); if(!item) return;

        document.getElementById('edit-id').value = id;
        document.getElementById('edit-dn').value = item.dn;
        document.getElementById('edit-cust').value = item.customer;
        document.getElementById('edit-unit').value = item.unit;
        document.getElementById('edit-qty').value = item.qty;
        document.getElementById('edit-kota').value = item.kota;
        document.getElementById('edit-vendor').value = item.vendor;
        document.getElementById('edit-nopol').value = item.nopol;
        document.getElementById('edit-driver').value = item.driver;
        document.getElementById('edit-stuffing').value = item.stuffing;
        document.getElementById('edit-bongkar').value = item.bongkar;

        const allFields = ['edit-dn','edit-cust','edit-unit','edit-qty','edit-kota','edit-vendor','edit-nopol','edit-driver','edit-stuffing','edit-bongkar'];
        allFields.forEach(f => {
            const el = document.getElementById(f); el.disabled = true; el.style.backgroundColor = '#f8fafc'; el.style.color = '#94a3b8'; el.style.boxShadow = 'none';
        });

        if (USER_ROLE === 'ADMIN') {
            allFields.forEach(f => { document.getElementById(f).disabled = false; document.getElementById(f).style.backgroundColor = '#fff'; document.getElementById(f).style.color = '#334155'; });
        }
        else if (USER_ROLE === 'VENDOR') {
            ['edit-nopol', 'edit-driver'].forEach(f => {
                const el = document.getElementById(f); el.disabled = false; el.style.backgroundColor = '#fff'; el.style.color = '#334155'; el.style.border = '1px solid #3b82f6'; el.style.boxShadow = '0 0 0 3px rgba(59,130,246,0.15)';
            });
        }
        else if (USER_ROLE === 'CUSTOMER') {
            ['edit-bongkar'].forEach(f => {
                const el = document.getElementById(f); el.disabled = false; el.style.backgroundColor = '#fff'; el.style.color = '#334155'; el.style.border = '1px solid #10b981'; el.style.boxShadow = '0 0 0 3px rgba(16,185,129,0.15)';
            });
        }
        
        const modal = document.getElementById('modal-edit');
        modal.style.display = 'flex';
        modal.style.opacity = '0';
        setTimeout(() => modal.style.opacity = '1', 10);
    }

    function simpanPerubahan() {
        const id = document.getElementById('edit-id').value;
        const updates = {};

        if (USER_ROLE === 'ADMIN') {
            updates.dn = document.getElementById('edit-dn').value.toUpperCase();
            updates.customer = document.getElementById('edit-cust').value.toUpperCase();
            updates.unit = document.getElementById('edit-unit').value.toUpperCase();
            updates.qty = document.getElementById('edit-qty').value;
            updates.kota = document.getElementById('edit-kota').value.toUpperCase();
            updates.vendor = document.getElementById('edit-vendor').value.toUpperCase();
            updates.nopol = document.getElementById('edit-nopol').value.toUpperCase();
            updates.driver = document.getElementById('edit-driver').value.toUpperCase();
            updates.stuffing = document.getElementById('edit-stuffing').value;
            updates.bongkar = document.getElementById('edit-bongkar').value;
        } 
        else if (USER_ROLE === 'VENDOR') {
            updates.nopol = document.getElementById('edit-nopol').value.toUpperCase();
            updates.driver = document.getElementById('edit-driver').value.toUpperCase();
        } 
        else if (USER_ROLE === 'CUSTOMER') {
            updates.bongkar = document.getElementById('edit-bongkar').value;
        }

        const btn = document.getElementById('btn-save-modal');
        const originalText = btn.innerHTML;
        btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> SAVING...';
        btn.disabled = true;

        db.collection("bookings").doc(id).update(updates)
            .then(() => { tutupModal(); })
            .catch((err) => { alert('Gagal: ' + err.message); })
            .finally(() => { btn.innerHTML = originalText; btn.disabled = false; });
    }

    function tutupModal() { 
        const modal = document.getElementById('modal-edit');
        modal.style.opacity = '0';
        setTimeout(() => modal.style.display = 'none', 200);
    }
    
    function resetData() { alert('Tindakan ini dibatasi demi keamanan data Enterprise.'); }
    
    function updateStats() {
        let dataHitung = localData;

        if (USER_ROLE === 'VENDOR') {
            dataHitung = dataHitung.filter(item => item.vendor && item.vendor.toUpperCase() === USER_NAME);
        } 
        else if (USER_ROLE === 'CUSTOMER') {
            dataHitung = dataHitung.filter(item => item.customer && item.customer.toUpperCase() === USER_NAME);
        }

        dataHitung = dataHitung.filter(item => !isHistory(item.bongkar));

        const total = dataHitung.length;
        const confirmed = dataHitung.filter(i => i.stuffing && i.bongkar).length;
        const pending = total - confirmed;

        if(document.getElementById('stat-total')) document.getElementById('stat-total').innerText = total.toLocaleString('id-ID');
        if(document.getElementById('stat-pending')) document.getElementById('stat-pending').innerText = pending.toLocaleString('id-ID');
        if(document.getElementById('stat-confirmed')) document.getElementById('stat-confirmed').innerText = confirmed.toLocaleString('id-ID');
    }

    function toggleSidebar() {
        document.getElementById('sidebar').classList.toggle('collapsed');
        document.getElementById('main-content').classList.toggle('expanded');
    }

    window.showPage = function(pageId) {
        document.getElementById('view-dashboard').classList.add('hidden');
        document.getElementById('view-input').classList.add('hidden');
        document.getElementById('view-history').classList.add('hidden'); 
        document.getElementById('view-dashboard-stats').classList.add('hidden'); 

        document.getElementById('menu-dashboard').classList.remove('active');
        document.getElementById('menu-input').classList.remove('active');
        document.getElementById('menu-history').classList.remove('active');
        document.getElementById('menu-dashboard-stats').classList.remove('active');
        
        document.getElementById(`view-${pageId}`).classList.remove('hidden');
        document.getElementById(`menu-${pageId}`).classList.add('active');
        
        if(pageId === 'dashboard-stats') {
            document.getElementById('page-subtitle').innerText = 'ANALYTICS & PERFORMANCE';
            renderAnalytics();
        } else if(pageId === 'dashboard') {
            document.getElementById('page-subtitle').innerText = 'MONITORING OVERVIEW';
            renderTable();
        } else if (pageId === 'history') {
            document.getElementById('page-subtitle').innerText = 'HISTORY ARCHIVE';
            renderHistory();
        } else {
            document.getElementById('page-subtitle').innerText = 'DATA ENTRY SYSTEM';
            document.getElementById('input-vendor-batch').value = ''; 
            document.getElementById('paste-area').value = '';
        }

        document.getElementById('checkAll').checked = false;
        document.getElementById('checkAllHistory').checked = false;
        updateDeleteButton();
    }

    window.toggleSelectAll = function() {
        const isChecked = document.getElementById('checkAll').checked;
        document.querySelectorAll('#table-body .row-chk').forEach(cb => cb.checked = isChecked);
        updateDeleteButton();
    }

    window.toggleSelectAllHistory = function() {
        const isChecked = document.getElementById('checkAllHistory').checked;
        document.querySelectorAll('#table-body-history .row-chk').forEach(cb => cb.checked = isChecked);
        updateDeleteButton();
    }

    window.updateDeleteButton = function() {
        const checkedCount = document.querySelectorAll('.row-chk:checked').length;
        
        if(document.getElementById('selected-count')) {
            document.getElementById('selected-count').innerText = checkedCount;
            document.getElementById('btn-delete-bulk').disabled = checkedCount === 0;
        }

        if(document.getElementById('selected-count-history')) {
            document.getElementById('selected-count-history').innerText = checkedCount;
            document.getElementById('btn-delete-history').disabled = checkedCount === 0;
        }
    }

    window.deleteSelected = function() {
        const checkboxes = document.querySelectorAll('.row-chk:checked');
        if(checkboxes.length === 0) return;

        if (confirm(`Hapus ${checkboxes.length} record secara permanen?\nData yang dihapus tidak dapat dipulihkan.`)) {
            const batch = db.batch(); 
            checkboxes.forEach((cb) => {
                const docId = cb.value; 
                const docRef = db.collection("bookings").doc(docId);
                batch.delete(docRef);
            });

            batch.commit().then(() => {
                document.getElementById('checkAll').checked = false;
                document.getElementById('checkAllHistory').checked = false;
                updateDeleteButton(); 
            }).catch((error) => {
                console.error("Gagal hapus:", error);
                alert("Error DB: " + error.message);
            });
        }
    }

    window.exportToExcel = function() {
        let db = localData; 
        if(db.length === 0) { alert('Tabel kosong, tidak ada data diexport.'); return; }

        let csvContent = "data:text/csv;charset=utf-8,";
        csvContent += "NO,CREATED,DN,CUSTOMER,KOTA,QTY,UNIT,VENDOR,NOPOL,DRIVER,TGL STUFFING,TGL BONGKAR\n";
        
        db.forEach((item, index) => {
            const created = new Date(item.created).toLocaleDateString('id-ID');
            const cust = item.customer.replace(/,/g, " ");
            const row = [
                index + 1, created, `'${item.dn}`, cust, item.kota, item.qty, item.unit, item.vendor, item.nopol, item.driver, item.stuffing || '-', item.bongkar || '-'
            ].join(",");
            csvContent += row + "\n";
        });

        const encodedUri = encodeURI(csvContent);
        const link = document.createElement("a");
        link.setAttribute("href", encodedUri);
        link.setAttribute("download", `DOCKPLAN_EXPORT_${new Date().getTime()}.csv`);
        document.body.appendChild(link); link.click(); document.body.removeChild(link);
    }

    function saveManual() {
        const dn = document.getElementById('man-dn').value.toUpperCase();
        const cust = document.getElementById('man-cust').value.toUpperCase();
        
        if(!dn || !cust) { alert('No DN dan Customer wajib diisi!'); return; }

        db.collection("bookings").add({
            created: new Date().toISOString(),
            dn: dn, customer: cust,
            kota: document.getElementById('man-kota').value.toUpperCase(),
            qty: parseFloat(document.getElementById('man-qty').value) || 0,
            unit: document.getElementById('man-unit').value.toUpperCase(),
            vendor: document.getElementById('man-vendor').value.toUpperCase(),
            nopol: document.getElementById('man-nopol').value.toUpperCase(),
            driver: document.getElementById('man-driver').value.toUpperCase(),
            stuffing: '', bongkar: '', isGb: false
        });

        ['man-dn','man-cust','man-kota','man-qty','man-unit','man-vendor','man-nopol','man-driver'].forEach(id => document.getElementById(id).value = '');
        showPage('dashboard');
    }

    function processPaste() {
        const rawText = document.getElementById('paste-area').value;
        const vendorBatch = document.getElementById('input-vendor-batch').value.toUpperCase().trim();
        const unitBatch = document.getElementById('input-unit-batch').value.toUpperCase().trim();
        const inputTime = new Date().toISOString();

        if(!rawText.trim()) { alert('Area input kosong.'); return; }

        const lines = rawText.trim().split('\n');
        const groupedData = {}; let singleDataList = [];

        lines.forEach((line) => {
            if(!line.trim()) return;
            const cols = line.split('\t').map(c => c.trim()).filter(c => c !== '');
            if(cols.length < 7) return;

            const dn = cols[1]; const customer = cols[3]; const kota = cols[4];
            let qty = parseFloat(cols[5].replace(/,/g, ''));
            let cleanUnit = unitBatch || '-';
            if(!unitBatch && cols[7]) cleanUnit = cols[7].split(/[ ;.,]/)[0].toUpperCase();

            const gbMatch = line.toUpperCase().match(/GB\s*(\d+)/);
            const entry = { created: inputTime, dn: dn, customer: customer, kota: kota, qty: qty, unit: cleanUnit, vendor: vendorBatch || '', nopol: '', driver: '', stuffing: '', bongkar: '', isGb: false };

            if (gbMatch) {
                const gbCode = "GB" + gbMatch[1];
                if (!groupedData[gbCode]) { groupedData[gbCode] = { ...entry }; groupedData[gbCode].dn = [entry.dn]; } 
                else {
                    groupedData[gbCode].qty += entry.qty;
                    if (!groupedData[gbCode].dn.includes(entry.dn)) groupedData[gbCode].dn.push(entry.dn);
                }
            } else { singleDataList.push(entry); }
        });

        const finalMergedList = [];
        for (const key in groupedData) {
            const item = groupedData[key]; item.dn = item.dn.join(', '); finalMergedList.push(item);
        }
        const allNewData = [...finalMergedList, ...singleDataList];

        if(allNewData.length > 0) {
            const batch = db.batch();
            allNewData.forEach((item) => { const docRef = db.collection("bookings").doc(); batch.set(docRef, item); });

            batch.commit().then(() => {
                document.getElementById('paste-area').value = ''; document.getElementById('input-vendor-batch').value = '';
                alert(`${allNewData.length} records processed and synced.`);
                showPage('dashboard');
            }).catch(err => { alert("Sync Error: " + err.message); });
        } else { alert('Format data tabular tidak dikenali.'); }
    }

    window.addEventListener('load', function() {
        const savedUser = localStorage.getItem('dockplan_session');
        if (savedUser) {
            try {
                const data = JSON.parse(savedUser);
                if(data && data.role && data.nama) { masukAplikasi(data.role, data.nama); } 
                else throw new Error("Invalid Session");
            } catch (e) {
                localStorage.removeItem('dockplan_session');
                document.getElementById('login-screen').classList.remove('hidden');
            }
        } else {
            document.getElementById('login-screen').classList.remove('hidden');
        }
    });
    </script>
    
    <div id="modal-edit" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(15,23,42,0.6); backdrop-filter: blur(4px); z-index: 9999; align-items: center; justify-content: center; transition: opacity 0.2s;">
    <div style="background: white; padding: 24px; width: 92%; max-width: 550px; border-radius: 12px; box-shadow: 0 10px 25px rgba(0,0,0,0.15); max-height: 90vh; overflow-y: auto; border: 1px solid #e2e8f0;">
        
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 1px solid #f1f5f9; padding-bottom: 15px;">
            <h3 style="font-weight: 700; color: #1e293b; font-size: 15px; letter-spacing: 0.5px;"><i class="fas fa-edit text-blue-500 mr-2"></i> UPDATE RECORD</h3>
            <button onclick="tutupModal()" style="background:none; border:none; color:#94a3b8; cursor:pointer; font-size:16px;"><i class="fas fa-times"></i></button>
        </div>
        
        <input type="hidden" id="edit-id">

        <div style="display: grid; gap: 12px;">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                <div>
                    <label style="font-size: 10px; font-weight: 600; color: #64748b; text-transform: uppercase; margin-bottom: 4px; display: block;">NO DN</label>
                    <input type="text" id="edit-dn" class="form-input">
                </div>
                <div>
                    <label style="font-size: 10px; font-weight: 600; color: #64748b; text-transform: uppercase; margin-bottom: 4px; display: block;">CUSTOMER</label>
                    <input type="text" id="edit-cust" class="form-input">
                </div>
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px;">
                <div>
                    <label style="font-size: 10px; font-weight: 600; color: #64748b; text-transform: uppercase; margin-bottom: 4px; display: block;">KOTA</label>
                    <input type="text" id="edit-kota" class="form-input">
                </div>
                <div>
                    <label style="font-size: 10px; font-weight: 600; color: #64748b; text-transform: uppercase; margin-bottom: 4px; display: block;">UNIT</label>
                    <input type="text" id="edit-unit" class="form-input">
                </div>
                <div>
                    <label style="font-size: 10px; font-weight: 600; color: #64748b; text-transform: uppercase; margin-bottom: 4px; display: block;">QTY (TON)</label>
                    <input type="number" id="edit-qty" class="form-input">
                </div>
            </div>

            <div style="background: #f8fafc; padding: 15px; border-radius: 8px; border: 1px solid #e2e8f0; margin-top: 5px;">
                <label style="font-size: 10px; font-weight: 700; color: #3b82f6; display: block; margin-bottom: 10px; letter-spacing: 0.5px;">FLEET ASSIGNMENT</label>
                <div style="margin-bottom: 12px;">
                    <label style="font-size: 10px; font-weight: 600; color: #64748b; text-transform: uppercase; margin-bottom: 4px; display: block;">VENDOR NAME</label>
                    <input type="text" id="edit-vendor" class="form-input">
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                    <div>
                        <label style="font-size: 10px; font-weight: 600; color: #64748b; text-transform: uppercase; margin-bottom: 4px; display: block;">NOPOL</label>
                        <input type="text" id="edit-nopol" class="form-input">
                    </div>
                    <div>
                        <label style="font-size: 10px; font-weight: 600; color: #64748b; text-transform: uppercase; margin-bottom: 4px; display: block;">DRIVER</label>
                        <input type="text" id="edit-driver" class="form-input">
                    </div>
                </div>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 5px;">
                <div style="background: #fffbeb; padding: 12px; border-radius: 8px; border: 1px solid #fde68a;">
                    <label style="font-size: 10px; font-weight: 700; color: #d97706; text-transform: uppercase; margin-bottom: 6px; display: block;"><i class="fas fa-box-open mr-1"></i> DATE STUFFING</label>
                    <input type="date" id="edit-stuffing" class="form-input" style="border-color: #fcd34d;">
                </div>
                <div style="background: #ecfdf5; padding: 12px; border-radius: 8px; border: 1px solid #a7f3d0;">
                    <label style="font-size: 10px; font-weight: 700; color: #059669; text-transform: uppercase; margin-bottom: 6px; display: block;"><i class="fas fa-check-double mr-1"></i> DATE BONGKAR</label>
                    <input type="date" id="edit-bongkar" class="form-input" style="border-color: #6ee7b7;">
                </div>
            </div>
        </div>

        <div style="margin-top: 25px; display: flex; justify-content: flex-end; gap: 10px; border-top: 1px solid #f1f5f9; padding-top: 15px;">
            <button onclick="tutupModal()" style="padding: 10px 20px; background: white; color: #64748b; border: 1px solid #cbd5e1; border-radius: 6px; font-weight: 600; font-size: 12px; cursor: pointer; transition: 0.2s;">CANCEL</button>
            <button id="btn-save-modal" onclick="simpanPerubahan()" style="padding: 10px 24px; background: #2563eb; color: white; border: none; border-radius: 6px; font-weight: 600; font-size: 12px; cursor: pointer; box-shadow: 0 2px 4px rgba(37,99,235,0.2); transition: 0.2s;"><i class="fas fa-save mr-1"></i> SAVE CHANGES</button>
        </div>
    </div>
</div>
</body>
</html>
